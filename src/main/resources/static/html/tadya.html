<!DOCTYPE html>
<html>
<head>
    <title>Tadya</title>
    <meta charset="utf-8" />
    <script type="text/javascript" src="https://www.bing.com/api/maps/mapcontrol?callback=GetMap&setMkt=tr-TR&setLang=tr&branch=release&key=AtEGXpWltd3FqxpW2NOpPSpz_YQb5XUTt1dwFLrQbtSEyvA1GwIo8TnARNadz3iS" async defer></script>
    <link rel="stylesheet" href="../css/style.css" />
    <script type="text/javascript">
    let levelofdestruction;

    function addClickHandlerToPolygons(polygons) {
      for (let i = 0; i < polygons.length; i++) {
        Microsoft.Maps.Events.addHandler(polygons[i], "click", function (e) {
          // Polygon tıklanınca databoxları açar
          showDatabox(e.target);
        });
      }
    }

    function showDatabox(polygon) {
      // Databoxların hepsini görünür yapar
      databox.style.display = "block";
      databox2.style.display = "block";
      databox3.style.display = "block";
    }

    function closeDatabox(databoxId) {
      //Tıklanan databoxı kapatır
      const databox = document.getElementById(databoxId);
      if (databox) {
        databox.style.display = "none";
      }
    }

    function GetMap() {
      //mapi yükler ve ayarlarını yapar
      var map = new Microsoft.Maps.Map("#tadyaMap", {
        credentials: "AtEGXpWltd3FqxpW2NOpPSpz_YQb5XUTt1dwFLrQbtSEyvA1GwIo8TnARNadz3iS",
        center: new Microsoft.Maps.Location(41.1267716, 29.109357),
        mapTypeId: Microsoft.Maps.MapTypeId.road,
        zoom: 14,
      });

      Microsoft.Maps.loadModule("Microsoft.Maps.GeoJson", function () {
        Microsoft.Maps.GeoJson.readFromUrl("../../data/beykozz.geojson", function (beykoz) {
          //Polygonları mape ekler
          map.entities.push(beykoz);

          //Her polygona event listener ekler
          addClickHandlerToPolygons(beykoz);
        });
      });
    }

    window.addEventListener("load", () => {
      const buttons = document.querySelectorAll("#databox2 .buttons button, #databox3 .buttons button");
      buttons.forEach((button, index) => {
        button.addEventListener("click", () => {
          levelofdestruction = index + 1;
          // Tıklanan level of destruction butonunu css dosyasındaki .clicked versiyonuna çevirir (etrafı siyah çizgi ile işaretlenir)
          buttons.forEach((btn) => btn.classList.remove("clicked"));
          button.classList.add("clicked");
        });
      });
    });
  </script>
</head>
<body id="page2">
<div id="tadyaMap"></div>
<div id="databox"> <!-- Databox1 ayarları-->
    <div class="close-button" onclick="closeDatabox('databox')">X</div>
    <div id="title">Level of destruction</div>
    <div class="buttons">
        <button>1</button>
        <button>2</button>
        <button>3</button>
        <button>4</button>
        <button>5</button>
    </div>
    <div class="rows">
        <div class="row">Level of destruction: 4</div>
        <div class="row">Bericht Zeit: 2023-06-01 16:02:12</div>
        <div class="row">Meldung Zeit: 2023-06-01 17:09:42</div>
        <div class="row">Tote: 0</div>
        <div class="row">Verletzte: 8</div>
        <div class="row">Autorisierte: Ahmet Sonuç</div>
        <div class="row">Einrichtung: AFAD</div>
        <div class="row">Nummer: 05214354532</div>
    </div>
</div>
<div id="databox2"> <!-- Databox 2 ayarları -->
    <div class="close-button" onclick="closeDatabox('databox2')">X</div>
    <div id="title">Level of destruction</div>
    <div class="buttons">
        <button>1</button>
        <button>2</button>
        <button>3</button>
        <button>4</button>
        <button>5</button>
    </div>
    <div class="rows">
        <div class="row"><br></div>
        <div class="row">Tote:</div>
        <input type="text" id="id" name="Tote:" /><br />
        <div class="row">Verletzte:</div>
        <input type="text" id="id" name="Verletzte" /><br />
        <div class="row"><br></div>
    </div>
    <div id="confirmbutton"><button>bestätigen</button></div>
</div>
<div id="databox3"> <!-- Databox 3 ayarları -->
    <div class="close-button" onclick="closeDatabox('databox3')">X</div>
    <div id="title">Level of destruction</div>
    <div class="buttons">
        <button>1</button>
        <button>2</button>
        <button>3</button>
        <button>4</button>
        <button>5</button>
    </div>
    <div class="row"><br></div>
    <div id="helpbutton"><button>Berichten</button></div>
</div>
</body>
</html>